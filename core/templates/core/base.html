{% load static %}
{% load i18n %}

<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" style="background-color: rgb(9, 36, 60);">

<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NVBR47B6');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-28X5PJN9VV"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-28X5PJN9VV');
    </script>
    
    <title>{% block title %}Jobsight{% endblock %}</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{% static 'images/favicon.png' %}">
    <!-- Apple Touch Icon (Webclip) -->
    <link rel="apple-touch-icon" href="{% static 'images/webclip.png' %}">
    <link rel="apple-touch-icon-precomposed" href="{% static 'images/webclip.png' %}">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!-- Microsoft Tile Icon -->
    <meta name="msapplication-TileImage" content="{% static 'images/webclip.png' %}">
    <meta name="msapplication-TileColor" content="#09243c">
    <!-- Google Fonts - Lora for Latin and BPG Arial for Georgian -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
    <!-- BPG Arial for Georgian fallback -->
    <link href="https://cdn.web-fonts.ge/fonts/bpg-arial/css/bpg-arial.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                fontFamily: {
                    'sans': ['Lora', 'Sylfaen', 'BPG Arial', 'serif'],
                    'serif': ['Lora', 'Sylfaen', 'BPG Arial', 'serif'],
                    'mono': ['Lora', 'Sylfaen', 'BPG Arial', 'serif'],
                    'display': ['Lora', 'Sylfaen', 'BPG Arial', 'serif'],
                    'body': ['Lora', 'Sylfaen', 'BPG Arial', 'serif'],
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Prevent white overscroll background */
        html {
            background-color: rgb(9, 36, 60);
        }
        
        /* Embed Sylfaen font if available */
        @font-face {
            font-family: 'Sylfaen Web';
            src: local('Sylfaen');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }
        
        /* Define fonts with unicode ranges */
        @font-face {
            font-family: 'Combined';
            src: local('Sylfaen'), local('BPG Arial');
            unicode-range: U+10A0-10FF; /* Georgian characters */
        }
        
        @font-face {
            font-family: 'Combined';
            src: local('Lora');
            unicode-range: U+0000-10A0, U+1100-FFFF; /* Everything else */
        }
        
        /* Global font settings */
        body, html {
            font-family: 'Combined', 'Lora', 'Sylfaen Web', 'BPG Arial', serif;
        }
        
        /* Apply Sylfaen to Georgian text */
        :lang(ka) {
            font-family: 'Sylfaen Web', 'Sylfaen', 'BPG Arial', serif !important;
        }
        
        /* Helper class for Georgian text */
        .georgian-text {
            font-family: 'Sylfaen Web', 'Sylfaen', 'BPG Arial', serif !important;
        }
        
        /* Keep Lora for English text */
        :lang(en) {
            font-family: 'Lora', serif;
        }
        
        /* Global icon sizing fixes */
        .fas, .far, .fab, .fa {
            font-size: 1em;
            line-height: inherit;
            vertical-align: middle;
        }
        
        /* Fix for specific icon areas */
        button .fas, button .far, 
        a .fas, a .far, 
        .alert .fas, .alert .far {
            font-size: 0.875em;
        }
        
        /* Jobsight logo font */
        .jobsight-logo {
            font-family: 'Lora', serif;
        }
        
        /* Add padding to the bottom of the page on mobile for the navigation bar */
        @media (max-width: 768px) {
            body {
                padding-bottom: 4rem; /* Adjust this value based on the height of your mobile nav */
            }
            
            /* Fix for job list page - remove extra space */
            body.job-list-page .min-h-screen {
                min-height: auto !important;
            }
            
            body.job-list-page footer {
                margin-top: 0 !important;
            }
        }
    </style>
    <!-- Safari detection and fixes -->
    <script>
        (function() {
            const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
            if (isSafari) {
                document.documentElement.classList.add('safari');
                console.log('Safari browser detected');
            }
        })();
    </script>
    
    <!-- Safari-specific CSS Fixes -->
    <style>
        html.safari .rounded-2xl,
        html.safari .rounded-3xl,
        html.safari .rounded-xl,
        html.safari .rounded-full {
            overflow: hidden !important;
            -webkit-mask-image: -webkit-radial-gradient(white, black) !important;
        }
        
        html.safari input,
        html.safari select,
        html.safari button,
        html.safari .btn {
            -webkit-appearance: none !important;
            appearance: none !important;
        }
        
        html.safari .bg-gradient-to-br {
            background-image: none !important;
        }
        
        html.safari .from-purple-500.to-blue-500 {
            background-color: #8b5cf6 !important;
        }
        
        html.safari .from-teal-500.to-teal-700,
        html.safari .from-teal-500 {
            background-color: #14b8a6 !important;
        }
        
        html.safari .enhanced-cta-box {
            border-radius: 1.5rem 1.5rem 0 0 !important;
            background-image: none !important;
            background-color: #fbbf24 !important;
        }
        
        html.safari .animate-fade-in,
        html.safari .animate-fade-in-delay,
        html.safari .animate-fade-in-delay-long,
        html.safari .animate-slide-up {
            opacity: 1 !important;
            transform: none !important;
            animation: none !important;
        }
        
        html.safari .pulse-animation,
        html.safari .pulse-animation-delay,
        html.safari .pulse-animation-delay-long {
            animation: none !important;
        }
    </style>
    
    {% block extra_head %}{% endblock %}
    
    <!-- Meta Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '9348612505240959');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=9348612505240959&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->
</head>

<body class="bg-gray-50 {% if request.resolver_match.url_name == 'job_list' %}job-list-page{% endif %}">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NVBR47B6"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    {% include 'core/components/base/navbar.html' %}
    
    {% block hero_section %}{% endblock %}
    
    <div class="min-h-screen {% if request.resolver_match.url_name == 'job_list' %}job-list-content{% endif %}">
        {% include 'core/components/base/alerts.html' %}
        {% block content %}{% endblock %}
    </div>
    
    {% block bottom_section %}{% endblock %}
    
    {% include 'core/components/base/footer.html' %}
    
    <!-- Mobile Bottom Navigation - available on all pages -->
    {% include 'core/components/mobile/base/mobile_bottom_nav.html' %}
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    {% include 'core/components/base/scripts.html' %}
    {% block extra_js %}{% endblock %}
    
    <!-- Script to apply Georgian font to Georgian text -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Georgian Unicode range: U+10A0 to U+10FF
        const georgianRegex = /[\u10A0-\u10FF]/;
        
        // Function to check if text contains Georgian characters
        function hasGeorgianChars(text) {
            return georgianRegex.test(text);
        }
        
        // Function to process text nodes
        function processTextNodes(node) {
            if (node.nodeType === Node.TEXT_NODE) {
                const text = node.nodeValue.trim();
                if (text && hasGeorgianChars(text)) {
                    // If the parent is not already styled for Georgian
                    if (!node.parentElement.classList.contains('georgian-text') && 
                        !node.parentElement.classList.contains('jobsight-logo')) {
                        
                        // Create a span with Georgian font
                        const span = document.createElement('span');
                        span.className = 'georgian-text';
                        span.textContent = node.nodeValue;
                        
                        // Replace the text node with the span
                        node.parentNode.replaceChild(span, node);
                    }
                }
            } else if (node.nodeType === Node.ELEMENT_NODE) {
                // Skip elements that are already styled or should be skipped
                if (node.classList && (
                    node.classList.contains('jobsight-logo') || 
                    node.classList.contains('georgian-text'))) {
                    return;
                }
                
                // Process child nodes
                Array.from(node.childNodes).forEach(processTextNodes);
            }
        }
        
        // Process the entire body
        processTextNodes(document.body);
        
        // Fix for job list page on mobile
        if (document.body.classList.contains('job-list-page') && window.innerWidth < 768) {
            document.querySelector('.job-list-content').style.minHeight = 'auto';
        }
    });
    </script>
    
    <!-- Safari-specific fixes -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (document.documentElement.classList.contains('safari')) {
                console.log('Applying Safari-specific JS fixes');
                
                // Fix Safari gradients
                document.querySelectorAll('.bg-gradient-to-br').forEach(function(el) {
                    el.style.backgroundImage = 'none';
                    if (el.classList.contains('from-purple-500')) {
                        el.style.backgroundColor = '#8b5cf6';
                    } else if (el.classList.contains('from-teal-500')) {
                        el.style.backgroundColor = '#14b8a6';
                    } else if (el.classList.contains('bg-amber-500')) {
                        el.style.backgroundColor = '#f59e0b';
                    }
                });
                
                // Fix border radius rendering
                document.querySelectorAll('.rounded-2xl, .rounded-3xl, .rounded-xl, .rounded-full').forEach(function(el) {
                    el.style.overflow = 'hidden';
                    el.style.webkitMaskImage = '-webkit-radial-gradient(white, black)';
                });
                
                // Fix CTA box
                const ctaBox = document.querySelector('.enhanced-cta-box');
                if (ctaBox) {
                    ctaBox.style.borderRadius = '1.5rem 1.5rem 0 0';
                    ctaBox.style.backgroundImage = 'none';
                    ctaBox.style.backgroundColor = '#fbbf24';
                }
                
                // Fix form elements
                document.querySelectorAll('input, select, button').forEach(function(el) {
                    el.style.webkitAppearance = 'none';
                    el.style.appearance = 'none';
                    el.style.borderRadius = '0.75rem';
                });
            }
        });
    </script>
</body>
</html> 